### heartbeat和keepalived简单对比

对于无状态的冗余高可用的应用场景，很少通过Heartbeat来实现，heartbeat并不适合这种场景，heartbeat主要用来构建面向数据资源的集群。
针对无状态的冗余高可用的应用场景，比较适合用面向网络的高可用工具来实现，如keepalived或者ucarp。

这两种高可用软件的区别如下：
面向集群的高可用产品，像heartbeat主要用来保证共享资源的唯一性或者一致性，让用户看起来该资源就像只有一份完整的数据一样。这对共享文件系统或者共享存储系统非常重要。
在switchover时，这类软件被设计成将服务在某一节点下线，并在另一节点上线。只有这样，共享资源才不会被并发访问。很好的完成这样的要求并不是一件容易的事情。

面向网络的高可用产品，如keepalived，保证同时只有一个共享ip提供出去。请注意，此处并不涉及服务或资源，仅仅和对外的IP地址有关。
此类高可用产品不会试图下线或上线任何服务，它只根据设定的检查条件考虑哪个节点向外提供服务比较合适。前提条件是：两个节点都必须起有对应的服务。
这类软件非常适合通过冗余实现路由、防火墙和代理的高可用，但是不适合共享的磁盘阵列和分布式文件系统。

这两类产品间的区别非常明显，特别是在脑裂情况下的表现。
面向集群的高可用产品在这种情况下往往是没有节点向外提供服务，以便能够保证共享资源不会因为并发访问导致冲突。
面向网络的高可用产品在这种情况下往往是两个节点都有对外的IP地址，两个节点都能向外提供服务。

这两类软件的区别还会影响他们切换时的耗时。如keepalived在处理故障时可以在一秒内甚至无时延地完成ip地址的切换，因为切换的过程中并不需要起停任何服务。

所以，我不会用heartbeat去实现路由、防火墙以及负载均衡的高可用，我也不会去用keepalived去实现文件服务、分布式存储或者分布式数据库的高可用。


        
####   参考资料
* [Re: HAProxy + Heartbeat](http://www.formilux.org/archives/haproxy/1003/3259.html)

